Init Stage
â”‚
â”œâ”€â”€ init_action, init_genprocess, init_sense, init_genmodel
â”‚        â†“
â”‚        Data structures: action, RR_tilde, Y_ext_tilde, mu_tilde_x, ...
â”‚
â”œâ”€â”€ Precompute Jacobians: âˆ‚f/âˆ‚x, âˆ‚f/âˆ‚v, âˆ‚g/âˆ‚x, âˆ‚g/âˆ‚v, âˆ‚g_ext/âˆ‚a
â”‚
â†“
Main Loop (t = 2:T)
â”‚
â”œâ”€â”€ update_action         â† ğŸ”´ focus
â”‚       â”œâ”€ âˆ‡F = Jáµ€ Î  Îµ_y
â”‚       â”œâ”€ uses âˆ‚g_ext/âˆ‚a, PI_y, e_y
â”‚       â””â”€ adds interaction-based force
â”‚
â”œâ”€â”€ update_genprocess     (RR_tilde â† F_tilde + dt updates)
â”‚       â””â”€ update_F_tilde (jerk dynamics)
â”‚
â”œâ”€â”€ update_sense          (Y_ext_tilde â† G(RR_tilde))
â”‚
â”œâ”€â”€ update_genmodel       (belief updates Î¼_x, Î¼_v â† VFE minimization)
â”‚
â†“
Plotting + Analysis
